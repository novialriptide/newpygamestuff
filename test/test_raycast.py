import unittest

from geometry import raycast, Circle, Line
from pygame import Rect
import math


class RaycastTest(unittest.TestCase):
    def test_raycast_errors(self):
        with self.assertRaises(TypeError):
            for x in ["1", 1, (0, 0, 0), [0, 0, 0], []]:
                raycast(x, (0, 0), [])

            for x in ["1", 1, (0, 0, 0), [0, 0, 0]]:
                raycast((0, 0), x, [])

            for x in ["1", 1, (0, 0, 0), [0, 0, 0]]:
                raycast((0, 0), (0, 0), x)

        with self.assertRaises(TypeError):
            raycast()
        with self.assertRaises(TypeError):
            raycast(1, 2, 3, 4, 5)

        with self.assertRaises(TypeError):
            for x in ["1", 1, (0, 0, 0), [0, 0, 0], []]:
                raycast(x, 4, 5, [])

            for x in [1, "1", (0, 0, 0), [0, 0, 0]]:
                raycast((0, 0), x, 5, [])

            for x in ["1", (0, 0, 0), [0, 0, 0], []]:
                raycast((0, 0), 4, x, [])

            for x in ["1", 1, (0, 0, 0), [0, 0, 0]]:
                raycast((0, 0), 4, 5, x)

    def test_raycast_valid(self):
        startendpos = [
            ((0, 0), (10, 10), (0.5, 0.5)),
            ((0, 0), (-1, -1), (-0.7071067811865476, -0.7071067811865476)),
        ]

        collisions = [
            Line(0, 10, 10, 0),
            Line(0, 1, 1, 0),
            Line(-1, -2, -3, -4),
            Circle((5, 5), 1),
            Circle((0, 0), 1),
        ]

        for x in startendpos:
            result = raycast(x[0], x[1], math.dist(x[0], x[1]), collisions)
            self.assertEqual(result, x[2])

        colliders = [
            Line(114.0, 28.0, 371.0, 342.0),
            Line(273.0, 105.0, 240.0, 616.0),
            Line(122.0, 55.0, 346.0, 769.0),
            Line(771.0, 310.0, 103.0, 556.0),
            Line(465.0, 156.0, 619.0, 522.0),
            Line(410.0, 73.0, 31.0, 623.0),
            Line(366.0, 246.0, 436.0, 209.0),
            Line(425.0, 682.0, 59.0, 568.0),
            Line(777.0, 509.0, 750.0, 111.0),
            Line(99.0, 211.0, 421.0, 149.0),
            Line(334.0, 614.0, 548.0, 274.0),
            Line(555.0, 640.0, 137.0, 271.0),
            Line(329.0, 742.0, 567.0, 281.0),
            Line(192.0, 650.0, 741.0, 558.0),
            Line(192.0, 686.0, 2.0, 667.0),
            Circle((250.0, 402.0), 45.0),
            Circle((469.0, 124.0), 48.0),
            Circle((671.0, 294.0), 40.0),
            Circle((382.0, 585.0), 33.0),
            Circle((645.0, 503.0), 30.0),
            Circle((88.0, 243.0), 38.0),
            Circle((676.0, 110.0), 14.0),
            Circle((551.0, 259.0), 6.0),
            Circle((212.0, 708.0), 47.0),
            Circle((645.0, 177.0), 16.0),
            Circle((262.0, 513.0), 19.0),
            Circle((776.0, 581.0), 19.0),
            Circle((717.0, 420.0), 48.0),
            Circle((310.0, 160.0), 42.0),
            Circle((329.0, 322.0), 7.0),
            Rect(559, 496, 17, 8),
            Rect(452, 253, 46, 6),
            Rect(265, 613, 16, 33),
            Rect(277, 473, 32, 43),
            Rect(155, 219, 30, 42),
            Rect(147, 746, 13, 47),
            Rect(579, 79, 16, 8),
            Rect(421, 461, 26, 21),
            Rect(241, 772, 38, 23),
            Rect(751, 200, 11, 44),
            Rect(50, 445, 30, 33),
            Rect(313, 14, 8, 18),
            Rect(169, 367, 40, 15),
            Rect(351, 741, 30, 37),
            Rect(131, 582, 35, 46),
        ]
        origin_pos = (269, 422)
        results = [
            (
                raycast(
                    origin_pos, (268.3979880973152, 422.7984871126235), 150, colliders
                ),
                (250.9853168438677, 445.89403311465475),
            ),
            (
                raycast(
                    origin_pos, (269.483304758753, 421.1245478253116), 150, colliders
                ),
                (281.7956956254654, 398.8220375258295),
            ),
            (
                raycast(
                    origin_pos, (269.9977982791786, 421.9336781026488), 150, colliders
                ),
                (291.0044471600039, 420.53740308410124),
            ),
            (
                raycast(
                    origin_pos, (269.5949206633099, 422.8037844265516), 150, colliders
                ),
                (279.40765593184534, 436.0615585755291),
            ),
            (
                raycast(
                    origin_pos, (268.6450757332113, 422.9348950555247), 150, colliders
                ),
                (259.93012016423677, 445.8906905109024),
            ),
            (
                raycast(
                    origin_pos, (268.0215465371811, 422.2064674819378), 150, colliders
                ),
                (252.3008136843175, 425.52376385799295),
            ),
            (
                raycast(
                    origin_pos, (269.4080820618134, 422.9129452507276), 150, colliders
                ),
                (276.3619332897451, 438.46982962980536),
            ),
            (
                raycast(
                    origin_pos, (268.1266953599065, 421.5128254875395), 150, colliders
                ),
                (253.10114242016172, 413.1307946453744),
            ),
            (
                raycast(
                    origin_pos, (268.9380947060056, 421.0019179720206), 150, colliders
                ),
                (266.73793978354763, 385.52942531131356),
            ),
            (
                raycast(
                    origin_pos, (269.80640949391227, 421.40864247013485), 150, colliders
                ),
                (290.3314481805528, 406.35718750866977),
            ),
            (
                raycast(
                    origin_pos, (269.9333151120639, 422.3590583540222), 150, colliders
                ),
                (286.2655373042672, 428.6422747533465),
            ),
            (
                raycast(
                    origin_pos, (269.15425144988757, 421.01196837590714), 150, colliders
                ),
                (273.73012916038215, 391.70195612483496),
            ),
            (
                raycast(
                    origin_pos, (268.00165377255126, 422.0574874781049), 150, colliders
                ),
                (252.46689492939097, 422.9520209418548),
            ),
            (
                raycast(
                    origin_pos, (268.8720363103726, 421.0082211465569), 150, colliders
                ),
                (263.9803128612093, 383.0950608750867),
            ),
            (
                raycast(
                    origin_pos, (268.3330619383477, 422.7451131604794), 150, colliders
                ),
                (251.24755627965362, 441.8332951847575),
            ),
            (
                raycast(
                    origin_pos, (268.6000146850117, 421.08347845208436), 150, colliders
                ),
                (254.6515969290511, 389.1222414925725),
            ),
            (
                raycast(
                    origin_pos, (269.5253219888177, 422.85090352453415), 150, colliders
                ),
                (278.2684393805133, 437.01278816361594),
            ),
            (
                raycast(
                    origin_pos, (269.053068536214, 422.9985908724118), 150, colliders
                ),
                (270.07736658153857, 442.2728115625234),
            ),
            (
                raycast(
                    origin_pos, (269.9649660284921, 421.73762514629607), 150, colliders
                ),
                (292.9292710414978, 415.4936165591593),
            ),
            (
                raycast(
                    origin_pos, (269.9726265649745, 422.2323737616555), 150, colliders
                ),
                (287.75785697484486, 426.48150805541115),
            ),
            (
                raycast(
                    origin_pos, (268.8370092192043, 422.98662759204046), 150, colliders
                ),
                (265.31369806127265, 444.3141897203311),
            ),
            (
                raycast(
                    origin_pos, (268.5401098929869, 421.11202416166236), 150, colliders
                ),
                (254.35455233011473, 393.7219321003448),
            ),
            (
                raycast(
                    origin_pos, (269.5805989126669, 422.81418972150846), 150, colliders
                ),
                (279.17161323338604, 436.2639312012171),
            ),
            (
                raycast(
                    origin_pos, (268.3103129728638, 421.27589240813256), 150, colliders
                ),
                (253.57427457148208, 405.8044149688685),
            ),
            (
                raycast(
                    origin_pos, (268.90280309328324, 422.9952651713612), 150, colliders
                ),
                (266.8793926767906, 443.7143392955313),
            ),
            (
                raycast(
                    origin_pos, (268.95577237933816, 421.0009785199654), 150, colliders
                ),
                (267.41174658778806, 386.12424519352584),
            ),
            (
                raycast(
                    origin_pos, (269.99339037972226, 421.88521518621684), 150, colliders
                ),
                (291.49980388797746, 419.4001803800826),
            ),
            (
                raycast(
                    origin_pos, (268.0294683483501, 421.7590263227119), 150, colliders
                ),
                (252.78832042523965, 417.9747958394711),
            ),
            (
                raycast(
                    origin_pos, (268.9690249682688, 422.9995201585807), 150, colliders
                ),
                (268.3464150656844, 443.09025497898045),
            ),
            (
                raycast(
                    origin_pos, (268.4266304765319, 421.1807031126887), 150, colliders
                ),
                (253.91993865384035, 400.4518590268966),
            ),
            (
                raycast(
                    origin_pos, (269.99937328369515, 422.03539830273365), 150, colliders
                ),
                (289.93481292054474, 422.7415215690916),
            ),
            (
                raycast(
                    origin_pos, (269.8600617162362, 422.51019000800176), 150, colliders
                ),
                (284.3300291920282, 431.0937982338933),
            ),
            (
                raycast(
                    origin_pos, (269.03538323999896, 422.99937381711106), 150, colliders
                ),
                (269.72393726404016, 442.44708022594716),
            ),
            (
                raycast(
                    origin_pos, (268.8239392167701, 421.0156207028749), 150, colliders
                ),
                (261.67819410937136, 381.06280771855984),
            ),
            (
                raycast(
                    origin_pos, (269.96945936667, 421.75474801453237), 150, colliders
                ),
                (292.7712620388368, 415.9863913717998),
            ),
            (
                raycast(
                    origin_pos, (269.96836069987745, 422.24955471330526), 150, colliders
                ),
                (287.5605224451787, 426.7832030545938),
            ),
            (
                raycast(
                    origin_pos, (268.00611300996553, 421.8895977761081), 150, colliders
                ),
                (252.64569409099587, 420.18334301518496),
            ),
            (
                raycast(
                    origin_pos, (269.99952062532833, 421.96904003321674), 150, colliders
                ),
                (290.6369143735751, 421.3298005730717),
            ),
            (
                raycast(
                    origin_pos, (269.686486550907, 421.27285749991916), 150, colliders
                ),
                (286.75165476420733, 403.1970349473505),
            ),
            (
                raycast(
                    origin_pos, (269.98277958204125, 422.18478174456067), 150, colliders
                ),
                (288.29755401851, 425.62831682958625),
            ),
            (
                raycast(
                    origin_pos, (269.77388113597107, 422.63333086723145), 150, colliders
                ),
                (282.5410867936706, 433.0817900109822),
            ),
            (
                raycast(
                    origin_pos, (268.1020656854993, 422.4401294887214), 150, colliders
                ),
                (251.9899388354523, 430.33761379042045),
            ),
            (
                raycast(
                    origin_pos, (268.97346391284213, 421.0003521439635), 150, colliders
                ),
                (268.06292189769056, 386.69908655561676),
            ),
            (
                raycast(
                    origin_pos, (269.8268371568, 421.43755861093365), 150, colliders
                ),
                (291.055994420043, 406.996798901904),
            ),
            (
                raycast(
                    origin_pos, (269.99526663621714, 421.9028180941068), 150, colliders
                ),
                (291.32106605342557, 419.82047979736905),
            ),
            (
                raycast(
                    origin_pos, (268.67419019478007, 422.94543533402475), 150, colliders
                ),
                (260.841442409198, 445.6745134659568),
            ),
            (
                raycast(
                    origin_pos, (268.6952037338691, 421.0475824255335), 150, colliders
                ),
                (255.2941502170418, 379.17240118459534),
            ),
            (
                raycast(
                    origin_pos, (269.9928708516677, 422.11919510018726), 150, colliders
                ),
                (289.0263093573188, 424.40417768959287),
            ),
            (
                raycast(
                    origin_pos, (269.4361511922465, 422.8998734008192), 150, colliders
                ),
                (276.81998689638027, 438.13430922098814),
            ),
            (
                raycast(
                    origin_pos, (269.9439841391523, 422.32999082567375), 150, colliders
                ),
                (286.6162625636468, 428.15815964226226),
            ),
            (
                raycast(
                    origin_pos, (268.7376106021874, 422.96496207382233), 150, colliders
                ),
                (262.69945147619563, 445.1708690230316),
            ),
            (
                raycast(
                    origin_pos, (268.6327086695453, 421.06989404981323), 150, colliders
                ),
                (254.84348337496417, 386.1509089513125),
            ),
            (
                raycast(
                    origin_pos, (269.0176868552884, 422.99984357534066), 150, colliders
                ),
                (269.36476469248976, 442.6202645043641),
            ),
            (
                raycast(
                    origin_pos, (268.8413922125653, 421.01265833179946), 150, colliders
                ),
                (262.5470049066482, 381.8297722740507),
            ),
            (
                raycast(
                    origin_pos, (269.3341653826308, 421.05748554544175), 150, colliders
                ),
                (278.30896448113845, 395.74403802282313),
            ),
            (
                raycast(
                    origin_pos, (269.96379136728524, 422.266657458824), 150, colliders
                ),
                (287.36266282793383, 427.08049892657897),
            ),
            (
                raycast(
                    origin_pos, (269.296354183637, 422.9550781108584), 150, colliders
                ),
                (274.50534260466986, 439.7423923967169),
            ),
            (
                raycast(
                    origin_pos, (268.8021864259957, 422.9802396594403), 150, colliders
                ),
                (264.43485207635007, 444.62200189495906),
            ),
            (
                raycast(
                    origin_pos, (268.35645033026026, 422.76540435233795), 150, colliders
                ),
                (251.15798027584856, 443.2203660315573),
            ),
            (
                raycast(
                    origin_pos, (269.8838633737085, 422.4677451620451), 150, colliders
                ),
                (284.8961341738888, 430.4123180982818),
            ),
            (
                raycast(
                    origin_pos, (268.5959485675644, 422.91473626797386), 150, colliders
                ),
                (258.29802996154956, 446.22830201078517),
            ),
            (
                raycast(
                    origin_pos, (268.7762590498644, 421.0253513519055), 150, colliders
                ),
                (259.0748674658873, 378.7646557294555),
            ),
            (
                raycast(
                    origin_pos, (268.86763331033336, 422.99120081692195), 150, colliders
                ),
                (266.0570419669621, 444.0377378467398),
            ),
            (
                raycast(
                    origin_pos, (268.51283865019667, 421.1266880172254), 150, colliders
                ),
                (254.237415014164, 395.53578568976366),
            ),
            (
                raycast(
                    origin_pos, (269.91293909993897, 422.40809582183914), 150, colliders
                ),
                (285.6601400796276, 429.44730240845786),
            ),
            (
                raycast(
                    origin_pos, (268.2882252443643, 421.29759221442265), 150, colliders
                ),
                (253.51521186757742, 406.7189919899376),
            ),
            (
                raycast(
                    origin_pos, (269.80377545971095, 422.59493277802324), 150, colliders
                ),
                (283.12707394777846, 432.4564766783424),
            ),
            (
                raycast(
                    origin_pos, (268.2944489933137, 422.7086591401823), 150, colliders
                ),
                (251.3858564239454, 439.6917384049667),
            ),
            (
                raycast(
                    origin_pos, (268.0410714500392, 422.2836477323549), 150, colliders
                ),
                (252.20760198022745, 426.9671329728415),
            ),
            (
                raycast(
                    origin_pos, (268.2432073566102, 421.34634497254973), 150, colliders
                ),
                (253.39859454577373, 408.5247935487763),
            ),
            (
                raycast(
                    origin_pos, (268.64923088679086, 421.0635380257488), 150, colliders
                ),
                (254.95062506570264, 384.49183610381675),
            ),
            (
                raycast(
                    origin_pos, (268.09070884551625, 421.58383945840865), 150, colliders
                ),
                (253.00124084700917, 414.6777553690398),
            ),
            (
                raycast(
                    origin_pos, (269.9775332947056, 421.78921893409984), 150, colliders
                ),
                (292.4460080746771, 416.9444437341926),
            ),
            (
                raycast(
                    origin_pos, (268.7848652926354, 422.97658438329063), 150, colliders
                ),
                (263.9834375217016, 444.77222784794674),
            ),
            (
                raycast(
                    origin_pos, (268.1962066067903, 422.59490854846143), 150, colliders
                ),
                (251.7015659497352, 434.80302423288816),
            ),
            (
                raycast(
                    origin_pos, (268.3497236100672, 421.2403022859742), 150, colliders
                ),
                (253.68391236127812, 404.1066904056629),
            ),
            (
                raycast(
                    origin_pos, (269.28791775064525, 421.042344859115), 150, colliders
                ),
                (277.1906315592854, 394.75680154396247),
            ),
            (
                raycast(
                    origin_pos, (269.71179592894083, 421.2976136707315), 150, colliders
                ),
                (287.439507333006, 403.8042540810508),
            ),
            (
                raycast(
                    origin_pos, (269.97562269791945, 422.21945466799406), 150, colliders
                ),
                (287.90533967831306, 426.25253025710316),
            ),
            (
                raycast(
                    origin_pos, (268.8501078884234, 422.98870235909857), 150, colliders
                ),
                (265.6348921329817, 444.19656559472617),
            ),
            (
                raycast(
                    origin_pos, (268.0870485986911, 422.40806830169487), 150, colliders
                ),
                (252.0387826662526, 429.5812744710583),
            ),
            (
                raycast(
                    origin_pos, (269.00886638087565, 421.00003930712745), 150, colliders
                ),
                (269.30329484112593, 387.7940569291279),
            ),
            (
                raycast(
                    origin_pos, (269.99808296091356, 421.9381097492813), 150, colliders
                ),
                (290.9586550543681, 420.6383630219311),
            ),
            (
                raycast(
                    origin_pos, (269.1323368104988, 422.99120480657984), 150, colliders
                ),
                (271.60037833945086, 441.47687494714575),
            ),
            (
                raycast(
                    origin_pos, (268.2374317991247, 422.64690782883946), 150, colliders
                ),
                (251.5736859110417, 436.78322725629346),
            ),
            (
                raycast(
                    origin_pos, (268.04362847487187, 421.7078467766324), 150, colliders
                ),
                (252.84703700425524, 417.06557850986576),
            ),
            (
                raycast(
                    origin_pos, (269.22377033018716, 421.0253580968746), 150, colliders
                ),
                (275.58105627529886, 393.3359085301083),
            ),
            (
                raycast(
                    origin_pos, (269.98802929907555, 422.15426634165726), 150, colliders
                ),
                (288.6386626625549, 425.06629028797835),
            ),
            (
                raycast(
                    origin_pos, (268.4709301037412, 421.1514217508841), 150, colliders
                ),
                (254.0743592806508, 398.060679017801),
            ),
            (
                raycast(
                    origin_pos, (269.4281962900561, 421.096314248656), 150, colliders
                ),
                (280.5172473375387, 397.6934551855306),
            ),
            (
                raycast(
                    origin_pos, (268.036200594936, 422.2666284058353), 150, colliders
                ),
                (252.22875061538832, 426.6396495617143),
            ),
            (
                raycast(
                    origin_pos, (269.4638021630104, 422.88593879787874), 150, colliders
                ),
                (277.26956659490133, 437.7962391561773),
            ),
            (
                raycast(
                    origin_pos, (268.41581564841545, 421.18837900263503), 150, colliders
                ),
                (253.88455566296892, 400.99975927948117),
            ),
            (
                raycast(
                    origin_pos, (269.9811113543339, 421.806556182841), 150, colliders
                ),
                (292.2791810740756, 417.4100891530688),
            ),
            (
                raycast(
                    origin_pos, (269.9537481220672, 422.300606918838), 150, colliders
                ),
                (286.965392714021, 427.66241885517036),
            ),
            (
                raycast(
                    origin_pos, (269.86675205727266, 422.4987392818033), 150, colliders
                ),
                (284.4848259255534, 430.91015013596916),
            ),
            (
                raycast(
                    origin_pos, (268.36327361479056, 421.228910180084), 150, colliders
                ),
                (253.7231324376593, 403.4993734653363),
            ),
            (
                raycast(
                    origin_pos, (269.72411798686994, 421.31032388681973), 150, colliders
                ),
                (287.78458664302815, 404.108881510233),
            ),
            (
                raycast(
                    origin_pos, (269.9661216600521, 421.7419129255888), 150, colliders
                ),
                (292.8899425353228, 415.61810667151315),
            ),
            (
                raycast(
                    origin_pos, (269.9715850561827, 422.2366906812751), 150, colliders
                ),
                (287.7084051824512, 426.5576093827572),
            ),
            (
                raycast(
                    origin_pos, (269.7391705453463, 422.67351830330915), 150, colliders
                ),
                (281.8922600161901, 433.7471849312616),
            ),
            (
                raycast(
                    origin_pos, (268.83262944010875, 422.9858940590559), 150, colliders
                ),
                (265.20518562514405, 444.35330365042273),
            ),
            (
                raycast(
                    origin_pos, (268.0799680557663, 422.39184336359006), 150, colliders
                ),
                (252.06252002313548, 429.21370509629605),
            ),
            (
                raycast(
                    origin_pos, (268.0047362937208, 421.9027880924817), 150, colliders
                ),
                (252.63162332978558, 420.40122662059304),
            ),
            (
                raycast(
                    origin_pos, (268.3135353686454, 421.27283680655637), 150, colliders
                ),
                (253.5830201707299, 405.6689906896067),
            ),
            (
                raycast(
                    origin_pos, (269.24098830528527, 421.0294719804582), 150, colliders
                ),
                (276.0210343467671, 393.7243102247777),
            ),
            (
                raycast(
                    origin_pos, (268.00048030839395, 421.96900990332784), 150, colliders
                ),
                (252.56129061823052, 421.4903180025519),
            ),
            (
                raycast(
                    origin_pos, (268.9602092400688, 421.0007919658929), 150, colliders
                ),
                (267.57715997132465, 386.27026801296364),
            ),
            (
                raycast(
                    origin_pos, (269.81930552914497, 421.42664282518444), 150, colliders
                ),
                (290.7831642056062, 406.75595117671935),
            ),
            (
                raycast(
                    origin_pos, (269.92513609314625, 422.3796356268293), 150, colliders
                ),
                (286.01372347360257, 428.98169234067586),
            ),
            (
                raycast(
                    origin_pos, (268.26980584285434, 422.68323970381584), 150, colliders
                ),
                (251.4690403672763, 438.4036476461154),
            ),
            (
                raycast(
                    origin_pos, (268.0316317778971, 422.24952552258475), 150, colliders
                ),
                (252.24964066510304, 426.31617030704075),
            ),
            (
                raycast(
                    origin_pos, (268.6204062050027, 421.0748467419938), 150, colliders
                ),
                (254.76834930145432, 387.31434869566175),
            ),
            (
                raycast(
                    origin_pos, (269.11041720391967, 421.00611467408027), 150, colliders
                ),
                (272.48784242017683, 390.6052962991513),
            ),
            (
                raycast(
                    origin_pos, (269.9992062338855, 422.03983594061054), 150, colliders
                ),
                (289.8873100256388, 422.8327266318784),
            ),
            (
                raycast(
                    origin_pos, (269.50635264402985, 422.86232650422215), 150, colliders
                ),
                (277.96022645402036, 437.25940635688437),
            ),
            (
                raycast(
                    origin_pos, (269.73621311874587, 421.3232502354736), 150, colliders
                ),
                (288.1307276432359, 404.4144461730958),
            ),
            (
                raycast(
                    origin_pos, (269.9705389152046, 421.75905557887046), 150, colliders
                ),
                (292.73112236180987, 416.1085499502973),
            ),
            (
                raycast(
                    origin_pos, (269.30899405909815, 422.9510639681126), 150, colliders
                ),
                (274.7190240218186, 439.602790473697),
            ),
            (
                raycast(
                    origin_pos, (268.8152034428328, 422.9827767968665), 150, colliders
                ),
                (264.7677413608176, 444.50780887201785),
            ),
            (
                raycast(
                    origin_pos, (269.86455902294915, 421.4974687115839), 150, colliders
                ),
                (292.5470762270883, 408.3130888224775),
            ),
            (
                raycast(
                    origin_pos, (269.0971669050476, 422.99526810084694), 150, colliders
                ),
                (270.936278798522, 441.8330544908441),
            ),
            (
                raycast(
                    origin_pos, (268.32651512010654, 421.2607990012487), 150, colliders
                ),
                (253.61861818335365, 405.1177608577662),
            ),
            (
                raycast(
                    origin_pos, (268.76335325067174, 421.0284042424792), 150, colliders
                ),
                (258.30353560671955, 378.08374315521417),
            ),
            (
                raycast(
                    origin_pos, (269.25813075881643, 421.0338900107375), 150, colliders
                ),
                (276.45297896503655, 394.10562018683845),
            ),
            (
                raycast(
                    origin_pos, (269.9819493183405, 422.18914422066405), 150, colliders
                ),
                (288.2484848562681, 425.70766555778596),
            ),
            (
                raycast(
                    origin_pos, (269.4599168742616, 421.1120380251557), 150, colliders
                ),
                (281.2530572823714, 398.34300989759583),
            ),
            (
                raycast(
                    origin_pos, (268.66999494646797, 422.9439791653651), 150, colliders
                ),
                (260.7125256920484, 445.7063129684626),
            ),
            (
                raycast(
                    origin_pos, (269.6401674977183, 421.23176463576254), 150, colliders
                ),
                (285.5513767357534, 402.1374593672082),
            ),
            (
                raycast(
                    origin_pos, (268.13102678508295, 422.4948591231418), 150, colliders
                ),
                (251.8994816550767, 431.7383295229033),
            ),
            (
                raycast(
                    origin_pos, (268.0001561581935, 422.01767178546737), 150, colliders
                ),
                (252.50955338960742, 422.29146114880643),
            ),
            (
                raycast(
                    origin_pos, (268.4449117720433, 421.1682085242178), 150, colliders
                ),
                (253.98171140635225, 399.4953173137578),
            ),
            (
                raycast(
                    origin_pos, (268.91164632711786, 421.0039108330635), 150, colliders
                ),
                (265.6823867831425, 384.5976093851186),
            ),
            (
                raycast(
                    origin_pos, (268.0449174225475, 422.29633978849733), 150, colliders
                ),
                (252.1915781060396, 427.21526023678075),
            ),
            (
                raycast(
                    origin_pos, (268.0197633221522, 421.80217165167284), 150, colliders
                ),
                (252.74029154959987, 418.7185157016505),
            ),
            (
                raycast(
                    origin_pos, (269.9037051119706, 421.57184457191556), 150, colliders
                ),
                (294.2789466448481, 410.0233960404991),
            ),
            (
                raycast(
                    origin_pos, (269.0132466055206, 422.9999122598719), 150, colliders
                ),
                (269.2737456582124, 442.6635306915489),
            ),
            (
                raycast(
                    origin_pos, (268.16576001747177, 422.5514015338674), 150, colliders
                ),
                (251.79394416363104, 433.3725615874102),
            ),
            (
                raycast(
                    origin_pos, (269.9625976995964, 422.2709348053162), 150, colliders
                ),
                (287.3129479781663, 427.154401467311),
            ),
            (
                raycast(
                    origin_pos, (269.06193538050366, 421.0019198385691), 150, colliders
                ),
                (271.02814557547305, 389.31671224246304),
            ),
            (
                raycast(
                    origin_pos, (269.8817775098879, 422.4716655839213), 150, colliders
                ),
                (284.84469603078907, 430.47537811025364),
            ),
            (
                raycast(
                    origin_pos, (269.5477040395322, 422.8366721491003), 150, colliders
                ),
                (278.63296940332214, 436.7153145333355),
            ),
            (
                raycast(
                    origin_pos, (268.011290864311, 422.14984740573345), 150, colliders
                ),
                (252.3655654763788, 424.52109216880103),
            ),
            (
                raycast(
                    origin_pos, (269.7024185134925, 421.2882358312594), 150, colliders
                ),
                (287.181554909576, 403.5765400996018),
            ),
            (
                raycast(
                    origin_pos, (269.9784472385456, 422.2064969766909), 150, colliders
                ),
                (288.0525161196223, 426.02094954338577),
            ),
            (
                raycast(
                    origin_pos, (268.8632329206361, 422.9906032333898), 150, colliders
                ),
                (265.9518452328834, 444.0777688769989),
            ),
            (
                raycast(
                    origin_pos, (269.99717442112524, 421.9248789386822), 150, colliders
                ),
                (291.0951325235857, 420.33548698205016),
            ),
            (
                raycast(
                    origin_pos, (268.71636672081786, 421.0410671749594), 150, colliders
                ),
                (255.48022124016313, 376.2911195841406),
            ),
            (
                raycast(
                    origin_pos, (269.2108252663483, 421.0224762370821), 150, colliders
                ),
                (275.2458788747928, 393.0400222602836),
            ),
            (
                raycast(
                    origin_pos, (269.9364672609989, 421.64924500135106), 150, colliders
                ),
                (293.6972014382945, 412.7496319221224),
            ),
            (
                raycast(
                    origin_pos, (269.4161194261751, 422.90930997088986), 150, colliders
                ),
                (276.49331628418463, 438.3744992029603),
            ),
            (
                raycast(
                    origin_pos, (268.00000000045435, 421.99996985564667), 150, colliders
                ),
                (252.52840779910244, 421.99950347450454),
            ),
            (
                raycast(
                    origin_pos, (268.9292928672058, 421.00250288152193), 150, colliders
                ),
                (266.3932294964491, 385.22512364638686),
            ),
            (
                raycast(
                    origin_pos, (269.8011616557387, 421.4015520061242), 150, colliders
                ),
                (290.15273793838605, 406.19942655326423),
            ),
            (
                raycast(
                    origin_pos, (269.98999675012203, 421.8589098346879), 150, colliders
                ),
                (291.76415814488513, 418.75574810174186),
            ),
        ]

        for r in results:
            self.assertAlmostEqual(r[0][0], r[1][0])
            self.assertAlmostEqual(r[0][1], r[1][1])

        colliders = [
            Line(434.0, 70.0, 683.0, 85.0),
            Line(381.0, 566.0, 466.0, 243.0),
            Line(594.0, 417.0, 105.0, 155.0),
            Line(62.0, 289.0, 132.0, 167.0),
            Line(84.0, 610.0, 186.0, 646.0),
            Line(642.0, 359.0, 604.0, 309.0),
            Line(610.0, 182.0, 287.0, 107.0),
            Line(466.0, 581.0, 85.0, 618.0),
            Line(520.0, 248.0, 177.0, 556.0),
            Line(238.0, 729.0, 69.0, 580.0),
            Line(145.0, 163.0, 188.0, 303.0),
            Line(247.0, 172.0, 676.0, 652.0),
            Line(511.0, 31.0, 153.0, 426.0),
            Line(30.0, 84.0, 605.0, 661.0),
            Line(582.0, 702.0, 411.0, 469.0),
            Circle((622.0, 69.0), 27.0),
            Circle((170.0, 538.0), 43.0),
            Circle((311.0, 633.0), 16.0),
            Circle((683.0, 519.0), 44.0),
            Circle((480.0, 723.0), 38.0),
            Circle((369.0, 269.0), 35.0),
            Circle((546.0, 369.0), 21.0),
            Circle((84.0, 271.0), 46.0),
            Circle((254.0, 463.0), 34.0),
            Circle((414.0, 215.0), 46.0),
            Circle((608.0, 612.0), 14.0),
            Circle((423.0, 461.0), 31.0),
            Circle((324.0, 382.0), 44.0),
            Circle((691.0, 44.0), 5.0),
            Circle((444.0, 665.0), 20.0),
            Rect(681, 636, 48, 47),
            Rect(75, 487, 39, 21),
            Rect(614, 708, 34, 10),
            Rect(138, 396, 36, 16),
            Rect(163, 94, 9, 36),
            Rect(535, 332, 32, 15),
            Rect(748, 68, 17, 23),
            Rect(780, 679, 12, 13),
            Rect(732, 57, 13, 42),
            Rect(157, 227, 14, 47),
            Rect(330, 382, 39, 12),
            Rect(476, 279, 45, 13),
            Rect(236, 4, 44, 35),
            Rect(586, 428, 37, 7),
            Rect(164, 234, 16, 27),
        ]
        origin_pos = (265, 539)

        results = [
            (
                raycast(origin_pos, 1.0, 150, colliders),
                (212.99990086346105, 538.092334893298),
            ),
            (
                raycast(origin_pos, 3.0, 150, colliders),
                (212.96530451566616, 536.2729771639968),
            ),
            (
                raycast(origin_pos, 7.0, 150, colliders),
                (212.6561542580106, 532.5729838846005),
            ),
            (
                raycast(origin_pos, 7.5, 150, colliders),
                (212.59338386701768, 532.100538095989),
            ),
            (
                raycast(origin_pos, 8.0, 150, colliders),
                (212.52482315381508, 531.6250948448816),
            ),
            (
                raycast(origin_pos, 9.5, 150, colliders),
                (212.28260158403089, 530.178133005087),
            ),
            (
                raycast(origin_pos, 11.5, 150, colliders),
                (211.86596668547085, 528.1897587445036),
            ),
            (
                raycast(origin_pos, 12.5, 150, colliders),
                (211.61233337800934, 527.164239258944),
            ),
            (
                raycast(origin_pos, 12.999999999999998, 150, colliders),
                (211.47291426392664, 526.6422985398898),
            ),
            (
                raycast(origin_pos, 16.0, 150, colliders),
                (212.64905127952184, 523.9886070143069),
            ),
            (
                raycast(origin_pos, 20.0, 150, colliders),
                (215.85271229786775, 521.1118501815065),
            ),
            (
                raycast(origin_pos, 22.0, 150, colliders),
                (217.3647440974995, 519.7541073410208),
            ),
            (
                raycast(origin_pos, 25.5, 150, colliders),
                (219.8921069307687, 517.4846386744118),
            ),
            (
                raycast(origin_pos, 27.0, 150, colliders),
                (220.93528575607053, 516.5479066680183),
            ),
            (
                raycast(origin_pos, 28.5, 150, colliders),
                (221.95761846757182, 515.629893620956),
            ),
            (
                raycast(origin_pos, 32.0, 150, colliders),
                (224.2728881065197, 513.5508759859823),
            ),
            (
                raycast(origin_pos, 35.0, 150, colliders),
                (226.19277963053543, 511.8268917603355),
            ),
            (
                raycast(origin_pos, 38.0, 150, colliders),
                (228.0664881098484, 510.1443780238096),
            ),
            (
                raycast(origin_pos, 39.0, 150, colliders),
                (228.68282564342817, 509.590932075289),
            ),
            (
                raycast(origin_pos, 44.0, 150, colliders),
                (231.72096364496258, 506.8628081555438),
            ),
            (
                raycast(origin_pos, 45.0, 150, colliders),
                (232.32258064516128, 506.3225806451613),
            ),
            (
                raycast(origin_pos, 46.50000000000001, 150, colliders),
                (233.22300607528865, 505.5140353609653),
            ),
            (
                raycast(origin_pos, 49.50000000000001, 150, colliders),
                (235.02119786583438, 503.8993325286385),
            ),
            (
                raycast(origin_pos, 52.5, 150, colliders),
                (236.82407627760776, 502.28042130174),
            ),
            (
                raycast(origin_pos, 55.5, 150, colliders),
                (238.64162939480138, 500.64833278834163),
            ),
            (
                raycast(origin_pos, 56.5, 150, colliders),
                (239.25251040602188, 500.0997865741844),
            ),
            (
                raycast(origin_pos, 58.00000000000001, 150, colliders),
                (240.17489322907633, 499.27152444736004),
            ),
            (
                raycast(origin_pos, 59.0, 150, colliders),
                (240.79444530844313, 498.7151919679286),
            ),
            (
                raycast(origin_pos, 60.50000000000001, 150, colliders),
                (241.73175872485345, 497.87352277768264),
            ),
            (
                raycast(origin_pos, 61.5, 150, colliders),
                (242.36258442062515, 497.3070670508672),
            ),
            (
                raycast(origin_pos, 70.0, 150, colliders),
                (249.60964584340567, 496.71534947734744),
            ),
            (
                raycast(origin_pos, 71.5, 150, colliders),
                (250.89959943241456, 496.85834485500607),
            ),
            (
                raycast(origin_pos, 75.5, 150, colliders),
                (254.13798904012194, 496.9997199845059),
            ),
            (
                raycast(origin_pos, 79.0, 150, colliders),
                (256.81336282873156, 496.88340286325905),
            ),
            (
                raycast(origin_pos, 79.5, 150, colliders),
                (257.18799804435486, 496.8502092825021),
            ),
            (
                raycast(origin_pos, 80.0, 150, colliders),
                (257.5612891043145, 496.81297413590664),
            ),
            (
                raycast(origin_pos, 84.0, 150, colliders),
                (260.519314539028, 496.369125519576),
            ),
            (
                raycast(origin_pos, 86.5, 150, colliders),
                (262.3672157395466, 495.9543578418376),
            ),
            (
                raycast(origin_pos, 88.5, 150, colliders),
                (263.8619159948719, 495.5383252935687),
            ),
            (
                raycast(origin_pos, 89.5, 150, colliders),
                (264.6186297581409, 495.2992987858796),
            ),
            (
                raycast(origin_pos, 90.5, 150, colliders),
                (265.3836534232002, 495.0376721179998),
            ),
            (
                raycast(origin_pos, 96.5, 150, colliders),
                (270.25680446872764, 492.86161932088675),
            ),
            (
                raycast(origin_pos, 100.0, 150, colliders),
                (273.4882963413031, 490.86047928004024),
            ),
            (
                raycast(origin_pos, 100.5, 150, colliders),
                (273.9881955015215, 490.5040368054029),
            ),
            (
                raycast(origin_pos, 101.0, 150, colliders),
                (274.5004613746452, 490.124363281498),
            ),
            (
                raycast(origin_pos, 103.49999999999999, 150, colliders),
                (277.3017848223363, 487.7593785078208),
            ),
            (
                raycast(origin_pos, 106.0, 150, colliders),
                (280.78918846012715, 483.9365561076264),
            ),
            (
                raycast(origin_pos, 108.0, 150, colliders),
                (285.6985382148536, 475.2964496925522),
            ),
            (
                raycast(origin_pos, 110.5, 150, colliders),
                (299.90838287351363, 445.6332888482735),
            ),
            (raycast(origin_pos, 121.50000000000001, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 125.0, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 125.5, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 127.00000000000001, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 128.5, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 131.0, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 144.0, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 144.5, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 146.0, 150, colliders), (265.0, 539.0)),
            (raycast(origin_pos, 147.5, 150, colliders), (265.0, 539.0)),
            (
                raycast(origin_pos, 154.0, 150, colliders),
                (395.5173716611492, 475.3424244668951),
            ),
            (
                raycast(origin_pos, 160.0, 150, colliders),
                (401.1455027733431, 489.4470894612964),
            ),
            (
                raycast(origin_pos, 164.5, 150, colliders),
                (397.79679205507443, 502.1721901907173),
            ),
            (
                raycast(origin_pos, 167.0, 150, colliders),
                (396.068289166806, 508.74050116613734),
            ),
            (
                raycast(origin_pos, 167.5, 150, colliders),
                (395.73227572734686, 510.017352236082),
            ),
            (
                raycast(origin_pos, 168.5, 150, colliders),
                (395.06917715147813, 512.5371268243832),
            ),
            (
                raycast(origin_pos, 169.0, 150, colliders),
                (394.7419140420009, 513.7807266403966),
            ),
            (
                raycast(origin_pos, 173.5, 150, colliders),
                (391.9104253993949, 524.5403834822993),
            ),
            (
                raycast(origin_pos, 176.5, 150, colliders),
                (390.1191085552987, 531.347387489865),
            ),
            (
                raycast(origin_pos, 177.5, 150, colliders),
                (389.5361488646381, 533.562634314375),
            ),
            (
                raycast(origin_pos, 179.0, 150, colliders),
                (388.67334903613573, 536.8412736626841),
            ),
            (
                raycast(origin_pos, 183.0, 150, colliders),
                (386.4305511778041, 545.3639055243444),
            ),
            (
                raycast(origin_pos, 184.49999999999997, 150, colliders),
                (385.6073669385044, 548.4920056336832),
            ),
            (
                raycast(origin_pos, 184.99999999999997, 150, colliders),
                (385.3347560570656, 549.5279269831507),
            ),
            (
                raycast(origin_pos, 185.49999999999997, 150, colliders),
                (385.06296099012695, 550.5607482375175),
            ),
            (
                raycast(origin_pos, 188.5, 150, colliders),
                (383.4468423181349, 556.7019991910875),
            ),
            (raycast(origin_pos, 194.0, 150, colliders), (265.0, 539.0)),
            (
                raycast(origin_pos, 200.5, 150, colliders),
                (395.61572463861023, 587.8352183421822),
            ),
            (
                raycast(origin_pos, 204.5, 150, colliders),
                (376.2795444671091, 589.7130101173674),
            ),
            (
                raycast(origin_pos, 205.5, 150, colliders),
                (372.1606493463568, 590.1130078062594),
            ),
            (
                raycast(origin_pos, 212.0, 150, colliders),
                (350.20941921912106, 592.2447545640224),
            ),
            (
                raycast(origin_pos, 213.0, 150, colliders),
                (347.40857260149716, 592.5167527919806),
            ),
            (
                raycast(origin_pos, 216.5, 150, colliders),
                (338.4937290475917, 593.3824987539084),
            ),
            (
                raycast(origin_pos, 225.0, 150, colliders),
                (321.07416267942585, 595.0741626794259),
            ),
            (
                raycast(origin_pos, 231.00000000000003, 150, colliders),
                (311.1856023862232, 596.0344690596056),
            ),
            (
                raycast(origin_pos, 233.5, 150, colliders),
                (307.47026985722215, 596.3952756306635),
            ),
            (
                raycast(origin_pos, 237.0, 150, colliders),
                (302.58125743113374, 596.8700616142994),
            ),
            (
                raycast(origin_pos, 238.0, 150, colliders),
                (301.2424693714852, 597.0000751529004),
            ),
            (
                raycast(origin_pos, 241.49999999999997, 150, colliders),
                (296.7294345970517, 597.4383488711525),
            ),
            (
                raycast(origin_pos, 242.50000000000003, 150, colliders),
                (295.48403836753863, 597.5592928619451),
            ),
            (
                raycast(origin_pos, 244.0, 150, colliders),
                (293.6482288083914, 597.7375735802874),
            ),
            (
                raycast(origin_pos, 245.5, 150, colliders),
                (291.84793007274715, 597.9124057409668),
            ),
            (
                raycast(origin_pos, 246.0, 150, colliders),
                (291.2551243530421, 597.9699748003608),
            ),
            (
                raycast(origin_pos, 246.5, 150, colliders),
                (290.6657611696664, 598.027209545203),
            ),
            (
                raycast(origin_pos, 251.5, 150, colliders),
                (284.9363952389129, 598.5836046618379),
            ),
            (
                raycast(origin_pos, 252.99999999999997, 150, colliders),
                (283.26612695886615, 598.745809192971),
            ),
            (
                raycast(origin_pos, 257.5, 150, colliders),
                (278.3511436690252, 599.2231172814858),
            ),
            (
                raycast(origin_pos, 260.0, 150, colliders),
                (275.664957660964, 599.4839804896177),
            ),
            (
                raycast(origin_pos, 262.0, 150, colliders),
                (273.52961297709254, 599.6913499208598),
            ),
            (
                raycast(origin_pos, 264.0, 150, colliders),
                (271.4006482065587, 599.8980997804654),
            ),
            (
                raycast(origin_pos, 264.5, 150, colliders),
                (270.8687933887447, 599.9497497234028),
            ),
            (
                raycast(origin_pos, 266.0, 150, colliders),
                (269.27285934426857, 600.1047354442574),
            ),
            (
                raycast(origin_pos, 266.5, 150, colliders),
                (268.74048783817517, 600.1564355642718),
            ),
            (
                raycast(origin_pos, 269.5, 150, colliders),
                (265.53641954707683, 600.4675918025148),
            ),
            (
                raycast(origin_pos, 276.0, 150, colliders),
                (258.46734188529683, 601.1540901581208),
            ),
            (
                raycast(origin_pos, 279.0, 150, colliders),
                (255.10402751944784, 601.4807112382689),
            ),
            (
                raycast(origin_pos, 282.5, 150, colliders),
                (251.0613227810864, 601.8733098611543),
            ),
            (
                raycast(origin_pos, 287.5, 150, colliders),
                (244.99022722835085, 602.4628913190315),
            ),
            (
                raycast(origin_pos, 288.0, 150, colliders),
                (244.35976303836802, 602.524117500211),
            ),
            (
                raycast(origin_pos, 290.0, 150, colliders),
                (241.7882177413574, 602.773847620918),
            ),
            (
                raycast(origin_pos, 291.5, 150, colliders),
                (239.80286616279625, 602.9666507925893),
            ),
            (
                raycast(origin_pos, 294.5, 150, colliders),
                (235.66561596803626, 603.36843099523),
            ),
            (
                raycast(origin_pos, 298.0, 150, colliders),
                (230.50840109890035, 603.8692628854086),
            ),
            (
                raycast(origin_pos, 302.0, 150, colliders),
                (224.07477496972453, 604.494050724725),
            ),
            (
                raycast(origin_pos, 303.0, 150, colliders),
                (222.35949029998562, 604.6606269262481),
            ),
            (
                raycast(origin_pos, 309.0, 150, colliders),
                (210.93027406427552, 605.7705508126556),
            ),
            (
                raycast(origin_pos, 313.5, 150, colliders),
                (200.6937491963953, 606.7646490281716),
            ),
            (
                raycast(origin_pos, 316.5, 150, colliders),
                (192.7812269214502, 607.5330567031663),
            ),
            (
                raycast(origin_pos, 320.0, 150, colliders),
                (182.08789495566205, 608.5715167628359),
            ),
            (
                raycast(origin_pos, 321.0, 150, colliders),
                (178.67732071917288, 608.9027273842273),
            ),
            (
                raycast(origin_pos, 325.0, 150, colliders),
                (162.993321192916, 610.4258454484569),
            ),
            (
                raycast(origin_pos, 327.5, 150, colliders),
                (151.06566916382204, 611.5841738607312),
            ),
            (
                raycast(origin_pos, 345.0, 150, colliders),
                (210.0187236413301, 553.732188599138),
            ),
            (
                raycast(origin_pos, 345.5, 150, colliders),
                (210.2380618496412, 553.1624001590925),
            ),
            (
                raycast(origin_pos, 348.5, 150, colliders),
                (211.31408280683507, 549.9225232996197),
            ),
            (
                raycast(origin_pos, 349.5, 150, colliders),
                (211.59612291219088, 548.8978235750956),
            ),
            (
                raycast(origin_pos, 354.5, 150, colliders),
                (212.57251895908036, 544.0481922488246),
            ),
            (
                raycast(origin_pos, 356.0, 150, colliders),
                (212.74741651778118, 542.6538565787237),
            ),
            (
                raycast(origin_pos, 357.5, 150, colliders),
                (212.87503901953437, 541.2758249454765),
            ),
        ]

        for r in results:
            self.assertAlmostEqual(r[0][0], r[1][0])
            self.assertAlmostEqual(r[0][1], r[1][1])


if __name__ == "__main__":
    unittest.main()
